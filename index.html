<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Universal TV Pro</title>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<style>
:root{
--primary:#e50914;
--bg:#0a0a0a;
--card:#1a1a1a;
--text:#fff;
}

html,body{
margin:0;
padding:0;
height:100%;
background:var(--bg);
color:var(--text);
font-family:Segoe UI,Roboto,sans-serif;
overflow:hidden;
}

.app-container{display:flex;height:100vh;}

.sidebar{
width:80px;
background:#000;
display:flex;
flex-direction:column;
align-items:center;
gap:20px;
padding-top:20px;
border-right:1px solid #222;
}

.nav-btn{
background:#222;
color:#aaa;
border:none;
border-radius:6px;
padding:8px 14px;
font-size:16px;
cursor:pointer;
}

.nav-btn.active{
background:var(--primary);
color:#fff;
}

.main-content{flex:1;display:flex;flex-direction:column;height:100%;}

.video-box{
height:45vh;
background:#000;
position:relative;
}

video{
width:100%;
height:100%;
object-fit:contain;
background:#000;
}

#loader{
position:absolute;
top:50%;
left:50%;
transform:translate(-50%,-50%);
width:40px;
height:40px;
border:4px solid #eee;
border-top:4px solid var(--primary);
border-radius:50%;
animation:spin 1s linear infinite;
display:none;
z-index:10;
}

@keyframes spin{
100%{transform:translate(-50%,-50%) rotate(360deg);}
}

#nowPlaying{
position:absolute;
bottom:10px;
left:10px;
background:rgba(0,0,0,.6);
padding:8px 12px;
border-radius:6px;
font-weight:bold;
}

.top-controls{
padding:10px;
border-bottom:1px solid #222;
}

.search-box{
width:95%;
padding:10px;
font-size:16px;
background:#222;
color:#fff;
border-radius:8px;
border:2px solid transparent;
outline:none;
}

.search-box:focus{border-color:var(--primary);}

.cat-bar{
display:flex;
gap:10px;
margin-top:10px;
overflow-x:auto;
}

.grid{
flex:1;
overflow-y:auto;
display:grid;
gap:15px;
padding:15px;
grid-template-columns:repeat(auto-fill,minmax(140px,1fr));
}

.card{
background:var(--card);
border-radius:10px;
padding:12px;
text-align:center;
cursor:pointer;
border:4px solid transparent;
outline:none;
transition:.2s;
}

.card:focus{
border-color:#fff;
box-shadow:0 0 15px var(--primary);
transform:scale(1.08);
}

.card img{
width:60px;
height:60px;
object-fit:contain;
margin-bottom:6px;
}

.card span{
font-size:14px;
font-weight:bold;
white-space:nowrap;
overflow:hidden;
text-overflow:ellipsis;
}
</style>
</head>

<body>

<div class="app-container">

<nav class="sidebar">
<button class="nav-btn active" onclick="filter('All',this)" id="homeBtn">üè†</button>
<button class="nav-btn" onclick="filter('Favorite',this)">‚≠ê</button>
</nav>

<main class="main-content">

<div class="video-box" id="vbox" onclick="toggleFullScreen()">
<div id="loader"></div>
<div id="nowPlaying"></div>
<video id="player" autoplay playsinline webkit-playsinline></video>
</div>

<div class="top-controls">
<input class="search-box" placeholder="‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..." oninput="searchChannel(this.value)">
<div class="cat-bar">
<button class="nav-btn active" onclick="filter('All',this)">All</button>
<button class="nav-btn" onclick="filter('Favorite',this)">Favorite</button>
<button class="nav-btn" onclick="filter('‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ',this)">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</button>
<button class="nav-btn" onclick="filter('Sports',this)">Sports</button>
</div>
</div>

<div class="grid" id="grid"></div>

</main>
</div>

<script>
const m3u='https://raw.githubusercontent.com/soheltanver85-a11y/Live-tv2/refs/heads/main/Live-tv2';
const video=document.getElementById('player');
const loader=document.getElementById('loader');
const nowPlaying=document.getElementById('nowPlaying');

let channels=[];
let filtered=[];
let currentUrl="";
let hls;
let favorites=JSON.parse(localStorage.getItem('tv_favs'))||[];

fetch(m3u).then(r=>r.text()).then(parse);

function parse(data){
let lines=data.split('\n'),item={};
lines.forEach(l=>{
if(l.startsWith('#EXTINF')){
item.name=l.split(',')[1];
item.logo=l.match(/tvg-logo="(.*?)"/)?.[1];
item.group=l.match(/group-title="(.*?)"/)?.[1]||'All';
}
else if(l.startsWith('http')){
item.url=l.trim();
channels.push({...item});
item={};
}
});
filtered=[...channels];
render(filtered);

let last=localStorage.getItem('last_tv_url');
if(last) play(last);
}

function render(list){
grid.innerHTML=list.map(c=>`
<div class="card" tabindex="0" onclick="play('${c.url}')" data-url="${c.url}">
<img src="${c.logo||'https://via.placeholder.com/100'}">
<span>${c.name}</span>
</div>`).join('');
}

function play(url){
currentUrl=url;
localStorage.setItem('last_tv_url',url);
loader.style.display='block';

let ch=channels.find(c=>c.url===url);
nowPlaying.innerText=ch?.name||"";

if(hls) hls.destroy();

if(Hls.isSupported()){
hls=new Hls({lowLatencyMode:true});
hls.loadSource(url);
hls.attachMedia(video);
hls.on(Hls.Events.MANIFEST_PARSED,()=>video.play());
hls.on(Hls.Events.ERROR,(e,d)=>{if(d.fatal) switchChannel('next');});
}
else{
video.src=url;
video.play();
}

video.onplaying=()=>loader.style.display='none';
}

function switchChannel(dir){
let i=filtered.findIndex(c=>c.url===currentUrl);
i=dir==='next'?(i+1)%filtered.length:(i-1+filtered.length)%filtered.length;
play(filtered[i].url);
}

function searchChannel(q){
filtered=channels.filter(c=>c.name.toLowerCase().includes(q.toLowerCase()));
render(filtered);
}

function filter(cat,btn){
document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
btn.classList.add('active');
filtered=cat==='All'?channels:
cat==='Favorite'?channels.filter(c=>favorites.includes(c.url)):
channels.filter(c=>c.group.toLowerCase().includes(cat.toLowerCase()));
render(filtered);
}

function toggleFullScreen(){
let box=document.getElementById('vbox
