<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Universal TV Pro</title>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<style>
:root{--p:#e50914;--b:#0a0a0a;--c:#1a1a1a}
body,html{margin:0;height:100%;background:var(--b);color:#fff;font-family:Segoe UI;overflow:hidden}
.app{display:flex;height:100vh}
.sidebar{width:80px;background:#000;display:flex;flex-direction:column;align-items:center;gap:20px;padding-top:20px}
.btn{background:#222;color:#aaa;border:none;padding:8px 14px;border-radius:6px;font-size:16px}
.btn.active{background:var(--p);color:#fff}
.main{flex:1;display:flex;flex-direction:column}
.video{height:45vh;background:#000;position:relative}
video{width:100%;height:100%;object-fit:contain}
#loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
width:40px;height:40px;border:4px solid #eee;border-top:4px solid var(--p);
border-radius:50%;animation:spin 1s linear infinite;display:none}
@keyframes spin{100%{transform:translate(-50%,-50%) rotate(360deg)}}
#now{position:absolute;bottom:10px;left:10px;background:rgba(0,0,0,.6);
padding:8px 12px;border-radius:6px;font-weight:bold}
.top{padding:10px;border-bottom:1px solid #222}
.search{width:95%;padding:10px;font-size:16px;background:#222;color:#fff;border-radius:8px;border:none}
.grid{flex:1;overflow-y:auto;display:grid;gap:15px;padding:15px;
grid-template-columns:repeat(auto-fill,minmax(140px,1fr))}
.card{background:var(--c);border-radius:10px;padding:12px;text-align:center;
border:4px solid transparent;cursor:pointer;outline:none}
.card:focus{border-color:#fff;box-shadow:0 0 15px var(--p);transform:scale(1.08)}
.card img{width:60px;height:60px;object-fit:contain}
.card span{font-size:14px;font-weight:bold;white-space:nowrap;overflow:hidden}
</style>
</head>

<body>
<div class="app">

<nav class="sidebar">
<button class="btn active">üè†</button>
</nav>

<div class="main">

<div class="video" id="vbox" onclick="fs()">
<div id="loader"></div>
<div id="now"></div>
<video id="player" autoplay playsinline webkit-playsinline></video>
</div>

<div class="top">
<input class="search" placeholder="‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®" oninput="search(this.value)">
</div>

<div class="grid" id="grid"></div>

</div>
</div>

<script>
const M3U = "https://raw.githubusercontent.com/soheltanver85-a11y/Live-tv2/main/Live-tv2";
const video=document.getElementById("player");
const grid=document.getElementById("grid");
const loader=document.getElementById("loader");
const now=document.getElementById("now");

let channels=[],filtered=[],current="",hls;

fetch(M3U).then(r=>r.text()).then(parse).catch(()=>alert("M3U ‡¶≤‡ßã‡¶° ‡¶π‡ßü‡¶®‡¶ø"));

function parse(t){
let l=t.split("\n"),o={};
l.forEach(x=>{
if(x.startsWith("#EXTINF")){
o.name=x.split(",")[1]||"TV";
o.logo=x.match(/tvg-logo="(.*?)"/)?.[1]||"";
}
else if(x.startsWith("http")){
o.url=x.trim();
channels.push({...o});
o={};
}
});
filtered=[...channels];
render(filtered);
}

function render(list){
grid.innerHTML=list.map(c=>`
<div class="card" tabindex="0" onclick="play('${c.url}')">
<img src="${c.logo||'https://via.placeholder.com/100'}">
<span>${c.name}</span>
</div>`).join("");
}

function play(url){
current=url;
loader.style.display="block";
let c=channels.find(x=>x.url===url);
now.innerText=c?.name||"";

if(hls) hls.destroy();
if(Hls.isSupported()){
hls=new Hls();
hls.loadSource(url);
hls.attachMedia(video);
hls.on(Hls.Events.MANIFEST_PARSED,()=>video.play());
}
else{video.src=url;video.play()}
video.onplaying=()=>loader.style.display="none";
}

function search(q){
filtered=channels.filter(c=>c.name.toLowerCase().includes(q.toLowerCase()));
render(filtered);
}

function fs(){
!document.fullscreenElement?
document.getElementById("vbox").requestFullscreen():
document.exitFullscreen();
}
</script>
</body>
</html>
