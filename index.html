<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Best Live TV Pro</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        :root { --main: #ff0040; --bg: #000; --fav: #ffc107; --card: #151515; }
        body, html { margin: 0; padding: 0; background: var(--bg); color: #fff; font-family: 'Segoe UI', Roboto, sans-serif; overflow: hidden; height: 100%; }

        /* ‡¶™‡ßç‡¶≤‡ßá‡ßü‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ï‡¶∂‡¶® - ‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡ßü‡¶æ‡¶Æ ‡¶•‡¶ø‡ßü‡ßá‡¶ü‡¶æ‡¶∞ ‡¶≤‡ßÅ‡¶ï */
        .video-section { width: 100%; height: 55vh; background: #000; position: relative; display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 30px rgba(0,0,0,0.9); }
        video { width: 100%; height: 100%; object-fit: contain; outline: none; }

        /* ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶è‡¶∞‡¶ø‡ßü‡¶æ */
        .content-area { height: 45vh; padding: 20px; overflow-y: auto; scroll-behavior: smooth; }
        .section-header { font-size: 18px; margin: 15px 0 10px; color: #eee; font-weight: 600; display: flex; align-items: center; gap: 10px; }
        .section-header i { color: var(--main); }

        /* ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶ó‡ßç‡¶∞‡¶ø‡¶° - ‡¶≤‡ßç‡¶Ø‡¶æ‡¶ó ‡¶õ‡¶æ‡ßú‡¶æ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤‡¶ø‡¶Ç */
        .channel-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 20px; padding-bottom: 30px; }

        /* ‡¶ï‡¶æ‡¶∞‡ßç‡¶° ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® - ‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡ßá‡¶∞ ‡¶∂‡ßç‡¶∞‡ßá‡¶∑‡ßç‡¶† ‡¶´‡ßã‡¶ï‡¶æ‡¶∏ ‡¶á‡¶´‡ßá‡¶ï‡ßç‡¶ü */
        .channel-card { 
            background: var(--card); border-radius: 18px; padding: 15px; text-align: center;
            cursor: pointer; border: 3px solid transparent; outline: none; 
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
        }
        .channel-card:focus, .channel-card:hover { 
            transform: scale(1.12); border-color: var(--main); 
            background: #202020; box-shadow: 0 0 25px rgba(255, 0, 64, 0.5);
            z-index: 10;
        }

        /* ‡¶≤‡ßã‡¶ó‡ßã ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
        .logo-box { width: 85px; height: 85px; background: #fff; border-radius: 50%; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; overflow: hidden; border: 3px solid #333; }
        .logo-box img { width: 75%; height: auto; object-fit: contain; }
        
        .fav-indicator { position: absolute; top: 10px; right: 10px; color: var(--fav); font-size: 20px; display: none; text-shadow: 0 0 5px #000; }
        .is-fav .fav-indicator { display: block; }
        .is-fav { border-color: rgba(255, 193, 7, 0.3); }

        .channel-name { font-size: 14px; font-weight: 500; color: #ddd; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® */
        #osd { position: absolute; top: 30px; left: 30px; background: rgba(0,0,0,0.85); padding: 12px 25px; border-radius: 12px; display: none; border-left: 6px solid var(--main); font-weight: bold; font-size: 18px; z-index: 100; animation: slideIn 0.3s; }
        @keyframes slideIn { from { transform: translateX(-50px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        /* ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤‡¶¨‡¶æ‡¶∞ ‡¶π‡¶æ‡¶á‡¶° */
        .content-area::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>

    <div class="video-section">
        <div id="osd"></div>
        <video id="tv-player" autoplay controls poster="https://via.placeholder.com/1920x1080?text=Live+TV+Pro"></video>
    </div>

    <div class="content-area">
        <div id="fav-container" style="display: none;">
            <div class="section-header">‚≠ê ‡¶™‡¶õ‡¶®‡ßç‡¶¶‡ßá‡¶∞ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</div>
            <div class="channel-grid" id="fav-grid"></div>
        </div>
        
        <div class="section-header">üì∫ ‡¶∏‡¶ï‡¶≤ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</div>
        <div class="channel-grid" id="all-grid">
            <div style="padding: 20px;">‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
        </div>
    </div>

    <script>
        const m3uUrl = 'https://raw.githubusercontent.com/soheltanver85-a11y/Live-tv2/refs/heads/main/Live-tv2';
        const video = document.getElementById('tv-player');
        let channels = [];
        let favorites = JSON.parse(localStorage.getItem('my_favs')) || [];
        let currentIndex = 0;
        let pressTimer;

        // ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡¶Ç ‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶® (‡¶∏‡ßÅ‡¶™‡¶æ‡¶∞ ‡¶´‡¶æ‡¶∏‡ßç‡¶ü)
        function playSource(url) {
            if (Hls.isSupported()) {
                const hls = new Hls({ capLevelToPlayerSize: true, lowLatencyMode: true });
                hls.loadSource(url); hls.attachMedia(video);
            } else { video.src = url; }
            video.play().catch(e => console.log("Autoplay blocked"));
        }

        async function startApp() {
            try {
                const res = await fetch(m3uUrl);
                const data = await res.text();
                const lines = data.split('\n');
                let n = '', l = '';
                
                lines.forEach(line => {
                    if (line.startsWith('#EXTINF')) {
                        n = (line.split(',')[1] || 'Unknown').trim();
                        l = (line.match(/tvg-logo="(.*?)"/) || ["",""])[1];
                    } else if (line.startsWith('http')) {
                        channels.push({ name: n, logo: l, url: line.trim() });
                    }
                });
                refreshUI();
                if(channels.length > 0) selectChannel(0);
            } catch (e) { showOSD("‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡¶∂‡¶® ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®!"); }
        }

        function refreshUI() {
            renderList(channels, 'all-grid');
            const favBox = document.getElementById('fav-container');
            if (favorites.length > 0) {
                favBox.style.display = 'block';
                renderList(favorites, 'fav-grid');
            } else { favBox.style.display = 'none'; }
        }

        function renderList(list, id) {
            const container = document.getElementById(id);
            container.innerHTML = list.map((ch, i) => {
                const isFav = favorites.some(f => f.url === ch.url);
                return `
                <div class="channel-card ${isFav ? 'is-fav' : ''}" tabindex="0" 
                     onclick="playFromGrid('${ch.url}')" 
                     oncontextmenu="event.preventDefault(); toggleFavorite('${ch.url}')"
                     onmousedown="holdStart('${ch.url}')" onmouseup="holdEnd()"
                     ontouchstart="holdStart('${ch.url}')" ontouchend="holdEnd()">
                    <span class="fav-indicator">‚≠ê</span>
                    <div class="logo-box">
                        <img src="${ch.logo}" onerror="this.src='https://via.placeholder.com/100?text=TV'">
                    </div>
                    <div class="channel-name">${ch.name}</div>
                </div>`;
            }).join('');
        }

        function holdStart(url) { pressTimer = setTimeout(() => toggleFavorite(url), 1200); }
        function holdEnd() { clearTimeout(pressTimer); }

        function toggleFavorite(url) {
            const ch = channels.find(c => c.url === url);
            const idx = favorites.findIndex(f => f.url === url);
            if (idx > -1) {
                favorites.splice(idx, 1);
                showOSD("‡¶´‡ßá‡¶≠‡¶æ‡¶∞‡¶ø‡¶ü ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡ßü‡ßá‡¶õ‡ßá");
            } else {
                favorites.push(ch);
                showOSD("‡¶´‡ßá‡¶≠‡¶æ‡¶∞‡¶ø‡¶ü‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‚≠ê");
            }
            localStorage.setItem('my_favs', JSON.stringify(favorites));
            refreshUI();
        }

        function playFromGrid(url) {
            const idx = channels.findIndex(c => c.url === url);
            if (idx > -1) selectChannel(idx);
        }

        function selectChannel(i) {
            if(i < 0) i = channels.length - 1;
            if(i >= channels.length) i = 0;
            currentIndex = i;
            playSource(channels[i].url);
            showOSD("üì∫ " + channels[i].name);
        }

        function showOSD(txt) {
            const el = document.getElementById('osd');
            el.innerText = txt; el.style.display = 'block';
            clearTimeout(window.hideOSD);
            window.hideOSD = setTimeout(() => el.style.display = 'none', 3500);
        }

        // ‡¶∞‡¶ø‡¶Æ‡ßã‡¶ü ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶Æ‡¶æ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏
        document.addEventListener('keydown', (e) => {
            switch(e.keyCode) {
                case 39: selectChannel(currentIndex + 1); break; // Right
                case 37: selectChannel(currentIndex - 1); break; // Left
                case 38: // Up (Vol)
                    video.volume = Math.min(video.volume + 0.1, 1);
                    showOSD("üîä ‡¶≠‡¶≤‡¶ø‡¶â‡¶Æ: " + Math.round(video.volume * 100) + "%");
                    break;
                case 40: // Down (Vol)
                    video.volume = Math.max(video.volume - 0.1, 0);
                    showOSD("üîâ ‡¶≠‡¶≤‡¶ø‡¶â‡¶Æ: " + Math.round(video.volume * 100) + "%");
                    break;
                case 13: // OK
                    video.paused ? video.play() : video.pause();
                    break;
            }
        });

        startApp();
    </script>
</body>
</html>
