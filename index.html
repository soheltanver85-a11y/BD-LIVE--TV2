<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Android TV Pro</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        :root { --accent: #ff0040; --bg: #030303; --card: #121212; --fav: #ffc107; }
        body, html { margin: 0; padding: 0; background: var(--bg); color: #fff; font-family: 'Inter', sans-serif; overflow: hidden; height: 100%; }

        /* ‡ßß. ‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡ßü‡¶æ‡¶Æ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∏‡ßá‡¶ï‡¶∂‡¶® */
        .player-container { width: 100%; height: 58vh; background: #000; position: relative; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        video { width: 100%; height: 100%; object-fit: contain; outline: none; }

        /* ‡ß®. ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶á‡¶®‡¶´‡ßã ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ (OSD) */
        .osd-info { 
            position: absolute; bottom: 20px; left: 20px; background: rgba(0,0,0,0.85); 
            padding: 15px 30px; border-radius: 12px; display: none; border-left: 8px solid var(--accent);
            z-index: 100; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        /* ‡ß©. ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶è‡¶∞‡¶ø‡ßü‡¶æ */
        .content-section { height: 42vh; padding: 10px 20px; overflow-y: auto; scroll-behavior: smooth; }
        .row-title { font-size: 22px; font-weight: bold; margin: 15px 0; color: #bbb; display: flex; align-items: center; gap: 10px; }
        .row-title span { color: var(--accent); }

        /* ‡ß™. ‡¶Æ‡¶æ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ü‡¶ø‡¶≠‡¶ø ‡¶ó‡ßç‡¶∞‡¶ø‡¶° (‡¶≤‡ßç‡¶Ø‡¶æ‡¶ó ‡¶´‡ßç‡¶∞‡¶ø) */
        .tv-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 25px; padding-bottom: 50px; }

        /* ‡ß´. ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶ï‡¶æ‡¶∞‡ßç‡¶° - ‡¶∂‡ßç‡¶∞‡ßá‡¶∑‡ßç‡¶† ‡¶´‡ßã‡¶ï‡¶æ‡¶∏ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
        .tv-card { 
            background: var(--card); border-radius: 20px; padding: 18px; text-align: center;
            cursor: pointer; border: 3px solid transparent; outline: none; 
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); position: relative;
        }
        .tv-card:focus { 
            transform: scale(1.15); border-color: var(--accent); 
            background: #1e1e1e; box-shadow: 0 0 35px rgba(255, 0, 64, 0.6); z-index: 10;
        }

        .logo-wrapper { 
            width: 90px; height: 90px; background: #fff; border-radius: 50%; 
            margin: 0 auto 12px; display: flex; align-items: center; justify-content: center; 
            overflow: hidden; border: 4px solid #222; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .logo-wrapper img { width: 75%; height: auto; object-fit: contain; }
        
        .fav-star { position: absolute; top: 10px; right: 10px; color: var(--fav); font-size: 22px; display: none; }
        .is-fav .fav-star { display: block; }

        .ch-name { font-size: 15px; font-weight: 600; color: #ddd; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        
        /* ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤‡¶¨‡¶æ‡¶∞ ‡¶π‡¶æ‡¶á‡¶° (‡¶ü‡¶ø‡¶≠‡¶ø‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø) */
        .content-section::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>

    <div class="player-container">
        <div id="osd-box" class="osd-info"></div>
        <video id="tv-main-player" autoplay controls poster="https://via.placeholder.com/1920x1080?text=Live+TV+Pro"></video>
    </div>

    <div class="content-section">
        <div id="fav-row" style="display: none;">
            <div class="row-title"><span>‚òÖ</span> ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶õ‡¶®‡ßç‡¶¶‡ßá‡¶∞ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤‡¶∏‡¶Æ‡ßÇ‡¶π</div>
            <div class="tv-grid" id="fav-grid"></div>
        </div>
        
        <div class="row-title"><span>‚ñ∂</span> ‡¶∏‡¶ï‡¶≤ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶≤‡¶æ‡¶á‡¶≠</div>
        <div class="tv-grid" id="main-grid">
            <div style="padding: 20px;">‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶Ö‡¶™‡ßç‡¶ü‡¶ø‡¶Æ‡¶æ‡¶á‡¶ú ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
        </div>
    </div>

    <script>
        const m3u = 'https://raw.githubusercontent.com/soheltanver85-a11y/Live-tv2/refs/heads/main/Live-tv2';
        const video = document.getElementById('tv-main-player');
        let channels = [];
        let favorites = JSON.parse(localStorage.getItem('tv_pro_favs')) || [];
        let currentIndex = 0;
        let pressTimer;

        // ‡¶∂‡ßç‡¶∞‡ßá‡¶∑‡ßç‡¶† ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡¶Ç ‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶® (No Lag)
        function playStream(url) {
            if (Hls.isSupported()) {
                const hls = new Hls({ 
                    capLevelToPlayerSize: true, 
                    autoStartLoad: true,
                    enableWorker: true // ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏ ‡¶¨‡¶æ‡ßú‡¶æ‡¶§‡ßá
                });
                hls.loadSource(url); hls.attachMedia(video);
            } else { video.src = url; }
            video.play().catch(() => {});
        }

        async function launch() {
            try {
                const res = await fetch(m3u);
                const text = await res.text();
                const lines = text.split('\n');
                let name = '', logo = '';
                
                lines.forEach(line => {
                    if (line.startsWith('#EXTINF')) {
                        name = (line.split(',')[1] || 'Unknown Channel').trim();
                        logo = (line.match(/tvg-logo="(.*?)"/) || ["",""])[1];
                    } else if (line.startsWith('http')) {
                        channels.push({ name, logo, url: line.trim() });
                    }
                });
                updateInterface();
                if(channels.length > 0) switchChannel(0);
            } catch (e) { showOSD("‡¶®‡ßá‡¶ü‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶ï ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ!"); }
        }

        function updateInterface() {
            renderGrid(channels, 'main-grid');
            const favSec = document.getElementById('fav-row');
            if (favorites.length > 0) {
                favSec.style.display = 'block';
                renderGrid(favorites, 'fav-grid');
            } else { favSec.style.display = 'none'; }
        }

        function renderGrid(list, id) {
            const grid = document.getElementById(id);
            grid.innerHTML = list.map((ch, i) => {
                const isFav = favorites.some(f => f.url === ch.url);
                return `
                <div class="tv-card ${isFav ? 'is-fav' : ''}" tabindex="0" 
                     onclick="playFromUI('${ch.url}')" 
                     onmousedown="holdStart('${ch.url}')" onmouseup="holdEnd()"
                     ontouchstart="holdStart('${ch.url}')" ontouchend="holdEnd()">
                    <span class="fav-star">‚òÖ</span>
                    <div class="logo-wrapper">
                        <img src="${ch.logo}" onerror="this.src='https://via.placeholder.com/100?text=TV'">
                    </div>
                    <div class="ch-name">${ch.name}</div>
                </div>`;
            }).join('');
        }

        function holdStart(url) { pressTimer = setTimeout(() => handleFav(url), 1200); }
        function holdEnd() { clearTimeout(pressTimer); }

        function handleFav(url) {
            const ch = channels.find(c => c.url === url);
            const idx = favorites.findIndex(f => f.url === url);
            if (idx > -1) {
                favorites.splice(idx, 1);
                showOSD("‡¶´‡ßá‡¶≠‡¶æ‡¶∞‡¶ø‡¶ü ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡ßü‡ßá‡¶õ‡ßá");
            } else {
                favorites.push(ch);
                showOSD("‡¶´‡ßá‡¶≠‡¶æ‡¶∞‡¶ø‡¶ü‡ßá ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡ßá‡¶õ‡ßá ‚≠ê");
            }
            localStorage.setItem('tv_pro_favs', JSON.stringify(favorites));
            updateInterface();
        }

        function playFromUI(url) {
            const idx = channels.findIndex(c => c.url === url);
            if (idx > -1) switchChannel(idx);
        }

        function switchChannel(i) {
            if(i < 0) i = channels.length - 1;
            if(i >= channels.length) i = 0;
            currentIndex = i;
            playStream(channels[i].url);
            showOSD("üì∫ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤: " + channels[i].name);
        }

        function showOSD(txt) {
            const osd = document.getElementById('osd-box');
            osd.innerText = txt; osd.style.display = 'block';
            clearTimeout(window.hOSD);
            window.hOSD = setTimeout(() => osd.style.display = 'none', 4000);
        }

        // ‡¶∞‡¶ø‡¶Æ‡ßã‡¶ü ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶Æ‡¶æ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶π‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶≤‡¶æ‡¶∞
        document.addEventListener('keydown', (e) => {
            switch(e.keyCode) {
                case 39: switchChannel(currentIndex + 1); break; // Right
                case 37: switchChannel(currentIndex - 1); break; // Left
                case 38: // Up (Vol+)
                    video.volume = Math.min(video.volume + 0.1, 1);
                    showOSD("üîä ‡¶≠‡¶≤‡¶ø‡¶â‡¶Æ: " + Math.round(video.volume * 100) + "%");
                    break;
                case 40: // Down (Vol-)
                    video.volume = Math.max(video.volume - 0.1, 0);
                    showOSD("üîâ ‡¶≠‡¶≤‡¶ø‡¶â‡¶Æ: " + Math.round(video.volume * 100) + "%");
                    break;
                case 13: // OK Button
                    video.paused ? video.play() : video.pause();
                    break;
            }
        });

        launch();
    </script>
</body>
</html>
